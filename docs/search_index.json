[["index.html", "Red de estrategias de protección de trigo en el Sudeste de Bs. As. Introducción Objetivos Protocolo", " Red de estrategias de protección de trigo en el Sudeste de Bs. As. Juan Edwards Introducción Objetivos Verificar la eficiencia de control de diferentes estrategias de protección foliar de trigo Estimar respuesta de rendimiento y su relación costo-beneficio Protocolo DBCA, con al menos 3 repeticiones Tratamientos: tipo de mezcla (doble o triple) x momento de aplicación (Z32 o Z39) Trat Z32 Z39 ID 1 - - Check 2 T + E - MD32 3 - T + E MD39 4 T + E + C - MT32 5 - T + E + C MT39 6 T + E T + E + C MD32_MT39 Mezcla T + E T + E + C producto Rubric Max 0,5 l/ha Orquesta Ultra 1,2 l/ha DMI epoxiconazole 10% 50 g/ha epoxiconazole 5% 60 g/ha QoI azoxistrobina 20% 100 g/ha pyraclostrobin 8,1% 97 g/ha SDHI - fluxapyroxad 5%: 60 g/ha Evaluación sanitaria: Al momento de cada aplicación (incidencia media de los testigos) Alrededor de antesis (incidencia y severidad de enfermedades presentes) Rendimiento Análisis económico "],["1-2020_sanidad.html", "1 Sanidad 1.1 Mancha 1.2 Roya estriada 1.3 Roya de la hoja", " 1 Sanidad pacman::p_load(tidyverse) source(here::here(&quot;0 themes.R&quot;)) # raw %&gt;%filter(id_ensayo == &quot;2020_INTA_BCE&quot;) pacman::p_load(tidyverse, googlesheets4, googledrive) gs4_auth(email = &quot;edwardsmolina@gmail.com&quot;) googledrive::drive_auth(email = &quot;edwardsmolina@gmail.com&quot;) red_sani &lt;- gs4_get(gs4_find(&quot;sanidad red - 2020&quot;)$id) Interesante que se trata de un dataset con 2 filas de encabezados La primer fila es una inclusión extra para faciltar el proceso. Fila 2 y 3 contienen la info de nuestro interés, y debemos fusionar. data_head &lt;- read_sheet(red_sani, sheet=&quot;full&quot;, n_max = 2) new_names &lt;- data_head %&gt;% t() %&gt;% as_tibble() %&gt;% unite(., col = &quot;name&quot;, V2, V1, na.rm=TRUE, sep = &quot;_&quot;) %&gt;% pull(name) Luego, leemos el cuerpo del dataset, pero indicamos los nuevos nombres dat_full &lt;- read_sheet(red_sani, sheet=&quot;full&quot;, skip = 3, col_names = new_names) %&gt;% drop_na(verdor) dat_full &lt;- dat_full %&gt;% rename_all( list( ~stringr::str_to_lower(.) %&gt;% stringr::str_replace_all(., &#39;e1&#39;, &#39;MA&#39;) %&gt;% stringr::str_replace_all(., &#39;e2&#39;, &#39;RE&#39;) %&gt;% stringr::str_replace_all(., &#39;e3&#39;, &#39;RH&#39;) ) ) %&gt;% mutate(ensayo = case_when( eval == 1 ~ &quot;LP&quot;, eval == 2 ~ &quot;PA&quot;)) %&gt;% select(ensayo, everything(), -id, -eval, -matches(&quot;e4|e5&quot;)) %&gt;% replace(is.na(.), 0) dat_full UPA &lt;- read_sheet(red_sani, sheet=&quot;red_UPA&quot;, skip = 0) %&gt;% mutate(ensayo = &quot;UPA&quot;) %&gt;% replace(is.na(.), 0) EEA &lt;- read_sheet(red_sani, sheet=&quot;red_EEA&quot;, skip = 0) %&gt;% mutate(ensayo = &quot;EEA&quot;)%&gt;% replace(is.na(.), 0) dat &lt;- bind_rows(dat_full, UPA, EEA) %&gt;% mutate(trat = factor(case_when( trt ==1 ~ &quot;test&quot;, trt ==2 ~&quot;rub_Z32&quot;, trt ==3 ~&quot;rub_Z39&quot;, trt ==4 ~&quot;orq_Z32&quot;, trt ==5 ~&quot;orq_Z39&quot;, trt ==6 ~&quot;rub_Z32_orq_Z39&quot;, trt ==7 ~&quot;rub_Z32_carbFMC_Z39&quot;))) %&gt;% mutate(MA_int = MA_inc/100*MA_sev) %&gt;% mutate(RE_int = RE_inc/100*RE_sev) %&gt;% mutate(RH_int = RH_inc/100*RH_sev) %&gt;% filter(!trt ==14) dat # save(dat, file=&quot;data/dat_full_20.RData&quot;) load(here::here(&quot;data/dat_full_20.RData&quot;)) Verificamos la presión de enfermedades (% severidad media en los testigos) dis_press &lt;- dat %&gt;% filter(trt == 1) %&gt;% group_by(ensayo) %&gt;% summarise(across(c(&quot;verdor&quot;, matches(&quot;int&quot;)), ~ mean(.x, na.rm = TRUE))) %&gt;% rename_all(~stringr::str_replace_all(., &#39;int&#39;, &#39;test&#39;)) # write_sheet(ss=nova_tr, sheet = &quot;dis_press&quot;) dis_press ## # A tibble: 4 x 5 ## ensayo verdor MA_test RE_test RH_test ## &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; ## 1 EEA 51.7 0.737 NaN 1.85 ## 2 LP 85.2 0.375 10.7 0 ## 3 PA 100 6.08 9.26 0 ## 4 UPA 45.8 11 NaN 25 dat %&gt;% filter(trt == 1) %&gt;% group_by(ensayo) %&gt;% summarise(across(matches(&quot;inc|sev&quot;), ~ mean(.x, na.rm = TRUE))) ## # A tibble: 4 x 7 ## ensayo MA_inc RE_inc RH_inc MA_sev RE_sev RH_sev ## &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; ## 1 EEA 10.3 NaN 19.3 5.33 NaN 7.33 ## 2 LP 18.6 66.6 0 1.8 15.1 0 ## 3 PA 62.2 82.0 0 9.66 11.4 0 ## 4 UPA 100 NaN 100 11 NaN 25 Hacemos calculos de % control para agregar a los graficos mean_fmc &lt;- dat %&gt;% mutate(MA_int = MA_inc/100*MA_sev) %&gt;% mutate(RE_int = RE_inc/100*RE_sev) %&gt;% mutate(RH_int = RH_inc/100*RH_sev) %&gt;% group_by(ensayo, trat) %&gt;% summarise( MA_int = mean(MA_int, na.rm = T), RE_int = mean(RE_int, na.rm = T), RH_int = mean(RH_int, na.rm = T) ) %&gt;% left_join(dis_press, by = &quot;ensayo&quot;) %&gt;% rowwise() %&gt;% mutate( control_MA=(1-(MA_int)/MA_test)*100, control_MA_lab = paste0(control_MA %&gt;% round, &quot;%&quot;)) %&gt;% mutate( control_RE=(1-(RE_int)/RE_test)*100, control_RE_lab = paste0(control_RE %&gt;% round, &quot;%&quot;)) %&gt;% mutate( control_RH=(1-(RH_int)/RH_test)*100, control_RH_lab = paste0(control_RH %&gt;% round, &quot;%&quot;)) mean_fmc %&gt;% head ## # A tibble: 6 x 15 ## # Rowwise: ensayo ## ensayo trat MA_int RE_int RH_int verdor MA_test RE_test RH_test control_MA ## &lt;chr&gt; &lt;fct&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; ## 1 EEA orq_Z32 0.107 NaN 0.327 51.7 0.737 NaN 1.85 85.5 ## 2 EEA orq_Z39 0.0367 NaN 0.00333 51.7 0.737 NaN 1.85 95.0 ## 3 EEA rub_Z32 0.137 NaN 0.177 51.7 0.737 NaN 1.85 81.4 ## 4 EEA rub_Z32_carbFMC_… 0.04 NaN 0 51.7 0.737 NaN 1.85 94.6 ## 5 EEA rub_Z32_orq_Z39 0.0333 NaN 0 51.7 0.737 NaN 1.85 95.5 ## 6 EEA rub_Z39 0.06 NaN 0 51.7 0.737 NaN 1.85 91.9 ## # … with 5 more variables: control_MA_lab &lt;chr&gt;, control_RE &lt;dbl&gt;, control_RE_lab &lt;chr&gt;, ## # control_RH &lt;dbl&gt;, control_RH_lab &lt;chr&gt; Ensayos con menos de 5% de severidad media (incidencia * severidad condicional) se consideran de baja presión de enfermedades, por lo cual no se incluyen en el análisis de eficiencia de control de las estrategias (tratamientos). Antes de plotear ordenamos los niveles fmc &lt;- c(&quot;test&quot;, &quot;rub_Z32&quot;, &quot;orq_Z32&quot;, &quot;rub_Z39&quot;, &quot;orq_Z39&quot;, &quot;rub_Z32_orq_Z39&quot;, &quot;rub_Z32_carbFMC_Z39&quot;) 1.1 Mancha dat %&gt;% semi_join(by = &quot;ensayo&quot;, dis_press %&gt;% filter(MA_test &gt;4.99)) %&gt;% # filter(trat %in% fmc) %&gt;% mutate(trat = fct_relevel(trat, fmc)) %&gt;% ggplot()+ aes(trat, MA_int)+ geom_hline(data=(mean_fmc %&gt;% semi_join(by = &quot;ensayo&quot;, dis_press %&gt;% filter(MA_test &gt;4.99)) %&gt;% filter(trat==&quot;test&quot;)), aes(yintercept = MA_test), col=&quot;red&quot;)+ geom_point()+ stat_summary(fun.data = &quot;mean_cl_boot&quot;, colour = &quot;red&quot;, size = 0.5)+ facet_grid(.~ensayo)+ stat_summary(data = mean_fmc %&gt;% semi_join(by = &quot;ensayo&quot;, dis_press %&gt;% filter(MA_test &gt;4.99)), aes(x=trat, y=MA_int, label=control_MA_lab), fun=mean, geom=&quot;text&quot;, size=4, vjust = -0.5, hjust=-0.005)+ geom_vline(xintercept = c(1.5,3.5,5.5), linetype = &quot;dashed&quot;)+ coord_flip()+ scale_y_continuous(breaks=scales::pretty_breaks())+ labs(x=&quot;&quot;, y = &quot;Severidad media (%)&quot;, title = &quot;Mancha amarilla&quot;)+ theme_bw() # ggsave(last_plot(), file = &quot;plots/MA_control.png&quot;, w=5, h=4) 1.2 Roya estriada dat %&gt;% semi_join(by = &quot;ensayo&quot;, dis_press %&gt;% filter(RE_test &gt;4.99)) %&gt;% # filter(trat %in% fmc) %&gt;% mutate(trat = fct_relevel(trat, fmc)) %&gt;% ggplot()+ aes(trat, RE_int)+ geom_point()+ stat_summary(fun.data = &quot;mean_cl_boot&quot;, colour = &quot;red&quot;, size = 0.5)+ facet_grid(.~ensayo)+ stat_summary(data = mean_fmc %&gt;% semi_join(by = &quot;ensayo&quot;, dis_press %&gt;% filter(RE_test &gt;4.99)), aes(x=trat, y=RE_int, label=control_RE_lab), fun=mean, geom=&quot;text&quot;, size=4, vjust = -0.5, hjust=-0.005)+ geom_vline(xintercept = c(1.5,3.5,5.5), linetype = &quot;dashed&quot;)+ geom_hline(data=(mean_fmc %&gt;% semi_join(by = &quot;ensayo&quot;, dis_press %&gt;% filter(RE_test &gt;4.99)) %&gt;% filter(trat==&quot;test&quot;)), aes(yintercept = RE_test), col=&quot;red&quot;)+ coord_flip()+ scale_y_continuous(breaks=scales::pretty_breaks())+ labs(x=&quot;&quot;, y = &quot;Severidad media (%)&quot;, title = &quot;Roya estriada&quot;)+ theme_bw() # ggsave(last_plot(), file = &quot;plots/RE_control.png&quot;, w=5, h=4) 1.3 Roya de la hoja dat %&gt;% semi_join(by = &quot;ensayo&quot;, dis_press %&gt;% filter(RH_test &gt;4.99)) %&gt;% # filter(trat %in% fmc) %&gt;% mutate(trat = fct_relevel(trat, fmc)) %&gt;% ggplot()+ aes(trat, RH_int)+ geom_point()+ stat_summary(fun.data = &quot;mean_cl_boot&quot;, colour = &quot;red&quot;, size = 0.5)+ facet_grid(.~ensayo)+ stat_summary(data = mean_fmc %&gt;% semi_join(by = &quot;ensayo&quot;, dis_press %&gt;% filter(RH_test &gt;4.99)), aes(x=trat, y=RH_int, label=control_RH_lab), fun=mean, geom=&quot;text&quot;, size=4, vjust = -0.5, hjust=-0.005)+ geom_vline(xintercept = c(1.5,3.5,5.5), linetype = &quot;dashed&quot;)+ geom_hline(data=(mean_fmc %&gt;% semi_join(by = &quot;ensayo&quot;, dis_press %&gt;% filter(RH_test &gt;4.99)) %&gt;% filter(trat==&quot;test&quot;)), aes(yintercept = RH_test), col=&quot;red&quot;)+ coord_flip()+ scale_y_continuous(breaks=scales::pretty_breaks())+ labs(x=&quot;&quot;, y = &quot;Severidad media (%)&quot;, title = &quot;Roya de la hoja&quot;)+ theme_bw() # ggsave(last_plot(), file = &quot;plots/RH_control.png&quot;, w=5, h=4) "],["2-2020_rinde.html", "2 Rendimiento", " 2 Rendimiento pacman::p_load(tidyverse, googlesheets4) source(here::here(&quot;0 themes.R&quot;)) load(&quot;data/red_todos_20.RData&quot;) # red20 %&gt;% count(trt) # raw %&gt;%filter(id_ensayo == &quot;2020_INTA_BCE&quot;) fmc &lt;- c(&quot;test&quot;, &quot;rub_Z32&quot;, &quot;orq_Z32&quot;, &quot;rub_Z39&quot;, &quot;orq_Z39&quot;, &quot;rub_Z32_orq_Z39&quot;, &quot;rub_Z32_carbFMC_Z39&quot;) dat_fmc &lt;- red20 %&gt;% filter(trt %in% fmc) sum_fmc &lt;- dat_fmc %&gt;% group_by(ensayo, trt) %&gt;% summarise(kg_ha = mean(kg_ha, na.rm = T)) %&gt;% filter(trt %in% c(&quot;test&quot;)) %&gt;% pivot_wider(names_from = trt, values_from = kg_ha) %&gt;% rename(rinde_test = test) mean_fmc &lt;- dat_fmc %&gt;% group_by(ensayo, trt) %&gt;% summarise(kg_ha = mean(kg_ha, na.rm = T)) %&gt;% left_join(sum_fmc, by = &quot;ensayo&quot;) %&gt;% rowwise() %&gt;% mutate(dif_test = kg_ha -rinde_test) # dat_mean %&gt;%filter(id_ensayo == &quot;2020_INTA_BCE&quot;) # load(here::here(&quot;data/data.Rdata&quot;)) dat_fmc %&gt;% mutate(trt = fct_relevel(trt, fmc)) %&gt;% ggplot()+ aes(trt, kg_ha)+ geom_point()+ stat_summary(fun.data = &quot;mean_cl_boot&quot;, colour = &quot;red&quot;, size = 0.5)+ facet_grid(.~ensayo)+ stat_summary(data = mean_fmc, aes(x=trt, y=kg_ha, label=dif_test %&gt;% round), fun=mean, geom=&quot;text&quot;, size=4,vjust = -0.5)+ geom_vline(xintercept = c(1.5,3.5,5.5), linetype = &quot;dashed&quot;)+ coord_flip()+ labs(y=&quot;kg/ha&quot;, x = &quot;&quot;)+ theme_dens1 # ggsave(last_plot(), file = &quot;plots/red_rinde.png&quot;, w=7, h=4) dat_fmc %&gt;% group_by(ensayo, trt) %&gt;% summarise(n = sum(!is.na(kg_ha)), mean= mean(kg_ha, na.rm =T), sd= sd(kg_ha, na.rm =T)) -&gt; smr # smr %&gt;% # write_sheet(ss=red, sheet = &quot;summary_20&quot;) pacman::p_load(lme4, emmeans, multcomp) dat_fmc %&gt;% group_by(ensayo) %&gt;% group_modify(~ broom::tidy(car::Anova(lmer(kg_ha ~ trt +(1|bk), data = .x)))) %&gt;% mutate(p.value = scales::pvalue(p.value, add_p = TRUE)) ## # A tibble: 4 x 5 ## # Groups: ensayo [4] ## ensayo term statistic df p.value ## &lt;fct&gt; &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt; ## 1 INTA_BCE trt 0.770 6 p=0.993 ## 2 LOS_PINOS trt 91.4 6 p&lt;0.001 ## 3 PABLO_ACOSTA trt 8.15 6 p=0.228 ## 4 UPA trt 22.2 6 p=0.001 # red &lt;- gs4_get(gs4_find(&quot;red_trigo_data&quot;)$id) res &lt;- dat_fmc %&gt;% group_by(ensayo) %&gt;% group_modify(~ lmer(kg_ha ~ trt + (1|bk), data = .x) %&gt;% emmeans(., ~ trt, type = &quot;response&quot;) %&gt;% cld(., Letters = letters, alpha = .05, type = &quot;response&quot;, reversed = T) %&gt;% broom::tidy() %&gt;% rename(kg_ha = estimate) %&gt;% mutate_if(is.character, as.factor) ) # res %&gt;% View res %&gt;% group_by(ensayo) %&gt;% mutate(test_kg_ha = kg_ha[trt == &quot;test&quot;]) %&gt;% mutate(dif_kg = kg_ha- test_kg_ha, `dif_%` = (kg_ha/test_kg_ha - 1) * 100, range = conf.high - conf.low) %&gt;% left_join(smr, by = c(&#39;ensayo&#39;, &#39;trt&#39;)) %&gt;% purrr::modify_if(., ~is.numeric(.), ~round(., 0)) %&gt;% ungroup() %&gt;% group_by(trt) %&gt;% summarise(rinde_medio=mean(kg_ha), resp_media=mean(`dif_%`)) %&gt;% arrange(desc(rinde_medio)) #%&gt;% ## # A tibble: 7 x 3 ## trt rinde_medio resp_media ## &lt;fct&gt; &lt;dbl&gt; &lt;dbl&gt; ## 1 rub_Z32_carbFMC_Z39 6509. 26 ## 2 rub_Z32_orq_Z39 6467 25.2 ## 3 orq_Z39 6270 21.2 ## 4 rub_Z32 6182. 19.8 ## 5 orq_Z32 6146. 19.2 ## 6 rub_Z39 6031. 17 ## 7 test 5132. 0 # write_sheet(ss=red, sheet = &quot;summary_20&quot;) # write_sheet(ss=red, sheet = &quot;emmeans_20_mix&quot;) "]]
